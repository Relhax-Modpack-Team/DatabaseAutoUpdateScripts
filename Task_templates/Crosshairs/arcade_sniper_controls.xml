<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<AutomationSequence documentVersion="1.0">
  <!-- arcade_sniper_controls.xml
    Author:  Willster419
    Created: 2021-08-12
    This sequence template is for comparing the crosshair files arcade, sniper, crosshairControls
    Required macros:
    {wotmod_name_source}         - the name(s) of the wotmod(s) to look for and extract from the source package
    {wotmod_name_modpack}        - the name(s) of the wotmod(s) to look for and extract from the modpack package
   -->
  <TaskDefinitions>
    <!-- compare the hashes. this is done in 3 steps:
      1. write the compare_start task (resets the internal counters for matches and differences)
      2. use compare tasks to compare files on disk or an entry in a zip file
      3. write the compare_end task (evaluates the counts from the compare tasks)
          if compare_end finds 0 differences, then the automation process will end early (nothing to update)
    -->
    <Task ID="compare_start" Command="compare_start"/>
    <Task ID="compare_arcade" Command="file_compare" FileA="{working_folder_source}\arcadeCrosshair.swf" FileB="{working_folder_modpack}\arcadeCrosshair.swf"/>
    <Task ID="compare_sniper" Command="file_compare" FileA="{working_folder_source}\sniperCrosshair.swf" FileB="{working_folder_modpack}\sniperCrosshair.swf"/>
    <Task ID="compare_controls" Command="file_compare" FileA="{working_folder_source}\crosshairControls.swf" FileB="{working_folder_modpack}\crosshairControls.swf"/>
    <Task ID="compare_end" Command="compare_end"/>

    <!-- Copy the files to the package directory for creation -->
    <Task ID="copy_arcade" Command="file_copy" SourceFilePath="{working_folder_source}\arcadeCrosshair.swf" DestinationFilePath="{workDirectory}\arcade\res\gui\flash\arcadeCrosshair.swf"/>
    <Task ID="copy_sniper" Command="file_copy" SourceFilePath="{working_folder_source}\sniperCrosshair.swf" DestinationFilePath="{workDirectory}\sniper\res\gui\flash\sniperCrosshair.swf"/>
    <Task ID="copy_controls" Command="file_copy" SourceFilePath="{working_folder_source}\crosshairControls.swf" DestinationFilePath="{workDirectory}\controls\res\gui\flash\crosshairControls.swf"/>

    <!-- Create the new wotmods, each swf gets its own -->
    <!-- https://superuser.com/questions/281573/what-are-the-best-options-to-use-when-compressing-files-using-7-zip -->
    <Task ID="create_new_arcade_wotmod" Command="shell_exec" Filename="7z.exe" Wd="{workDirectory}\arcade" Cmd="a -tzip -mx=0 -r crosshair_arcade_new.wotmod res"/>
    <Task ID="create_new_sniper_wotmod" Command="shell_exec" Filename="7z.exe" Wd="{workDirectory}\sniper" Cmd="a -tzip -mx=0 -r crosshair_sniper_new.wotmod res"/>
    <Task ID="create_new_controls_wotmod" Command="shell_exec" Filename="7z.exe" Wd="{workDirectory}\controls" Cmd="a -tzip -mx=0 -r crosshair_Controls.wotmod res"/>

    <!-- move new wotmods to paths for 7zip to create a new zip file -->
    <Task ID="move_wotmod_arcade" Command="file_copy" SourceFilePath="{workDirectory}\arcade\crosshair_arcade_new.wotmod" DestinationFilePath="{working_folder_package}\zip\mods\versiondir\crosshair_arcade.wotmod"/>
    <Task ID="move_wotmod_sniper" Command="file_copy" SourceFilePath="{workDirectory}\sniper\crosshair_sniper_new.wotmod" DestinationFilePath="{working_folder_package}\zip\mods\versiondir\crosshair_sniper.wotmod"/>
    <Task ID="move_wotmod_controls" Command="file_copy" SourceFilePath="{workDirectory}\controls\crosshair_Controls.wotmod" DestinationFilePath="{working_folder_package}\zip\mods\versiondir\crosshair_Controls.wotmod"/>
  </TaskDefinitions>
</AutomationSequence>