<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<AutomationSequence documentVersion="1.0">
  <!-- GarageGraphics_GuP.xml
    Author:  Willster419
    Created: 2021-12-05
    This sequence template handles the downloading of the GuP mod from the wgmods source (the github version is no longer maintained as of this file's creation)
    Required macros:
    {package_url}        - dev url to use for the macro_substring_browser task
    {target_package_uid} - the target package to update the Version property
   -->
  <TaskDefinitions>
    <!-- create work dirs and macros -->
    <Task ID="import_createWD" Command="import_task" RepoUrlPath="Task_templates/create_workDirs_macros.xml"/>

    <!-- Create macro to be used later for updating this package's version -->
    <Task ID="create_package_to_update_macro" Command="macro_create" MacroName="target_package_uid" MacroValue="this"/>

    <!-- Get the download url for this package (wgmods) -->
    <Task ID="get_download_url" Command="retrieve_package_property" PropertyName="DevURLList" TargetPackageUID="{target_package_uid}" MacroSaveName="download_url" PropertyIndex="1"/>
    <Task ID="create_package_url_macro" Command="macro_create" MacroName="package_url" MacroValue="{download_url}"/>

    <!-- Download the source from wgmods -->
    <Task ID="download_source" Command="download_browser" Url="{download_url}" DestinationPath="{working_folder_source}\{packageName}.zip" HtmlPath="{wgmods_xpath}" WaitTimeMs="500" WaitCounts="6" BrowserHeight="0" BrowserWidth="0"/>

    <!-- Download modpack package -->
    <Task ID="download_modpack" Command="package_download" FilePath="{working_folder_modpack}\{packageName}.zip"/>
  </TaskDefinitions>
</AutomationSequence>